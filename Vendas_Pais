# Carregar os pacotes necessários
library(tidyverse)
library(scales)  # Para a formatação de números

# Carregar os dados
fact_sales <- factSales
territorios <- territory

# Mesclar os dados de vendas com os dados de território usando a chave de território
sales_by_country <- fact_sales %>%
    left_join(territorios, by = c("SalesTerritoryKey" = "Territory Key")) %>%
    group_by(Country) %>%
    summarise(TotalSales = sum(SalesAmount, na.rm = TRUE)) %>%
    arrange(desc(TotalSales))  # Reordenar os países com base nas vendas totais

# Criar o gráfico de barras
ggplot(sales_by_country, aes(x = reorder(Country, -TotalSales), y = TotalSales, fill = Country)) +
    geom_bar(stat = "identity") +
    labs(title = "Vendas por País",
         x = "País",
         y = "Total de Vendas",
         fill = "País") +
    scale_y_continuous(labels = comma) +  # Formatação de milhares no eixo y
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
