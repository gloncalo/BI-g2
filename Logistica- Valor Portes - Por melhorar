library(ggplot2)

Função para calcular a soma dos portes por país e criar o gráfico de bolhas correspondente
plot_bubble_chart <- function(data) {
  # Calculando a soma dos portes por país
  soma_portes_pais <- aggregate(Freight ~ Country, data = data, sum)

  # Ordenando os países pelo valor dos portes
  soma_portes_pais$Country <- factor(soma_portes_pais$Country, levels = soma_portes_pais$Country[order(soma_portes_pais$Freight)])

  # Criando o gráfico de bolhas
  grafico_bolhas <- ggplot(soma_portes_pais, aes(x = Country, y = Freight, size = Freight, label = paste0("$", round(Freight, 2)))) +
    geom_point(color = "dodgerblue", alpha = 0.7) +
    geom_text(vjust = -0.5, size = 3) +
    labs(
      title = "Total de Portes por País",
      x = "País",
      y = "Total de Portes",
      size = "Total de Portes"
    ) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

  # Exibindo o gráfico
  print(grafico_bolhas)
}

Chamando a função com o conjunto de dados
plot_bubble_chart(facts_dims)


